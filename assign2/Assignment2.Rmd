---
title: 'Assignment 2'
output: html_document
---

```{r}
library(dplyr)
library(ggplot2)
# Loading data
data(CPS85, package = "mosaicData")

df <- CPS85 %>%
  group_by(sector, sex) %>%
  summarise(n = n())

print(df)
```

Construct a stacked bar chart to show the number of females and males in each sectors.

Hint: `geom_text()` may help you show the numbers in the bars. The two color values `#C73C68` and `#B6C468` can help.
```{r}
ggplot(df, aes(y = reorder(sector, n, sum, decreasing = TRUE), x = n, fill = sex)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = n), position = position_stack(vjust = 0.5), color = "black", size = 3) +
  labs(
    x = "Number of persons",
    y = ""
  ) +
  scale_fill_manual(values = c("F" = "#C73C68", "M" = "#B6C468"))
# + theme_minimal()
```
Based on the dataset SaratogaHouses from package mosaicData, please draw a scatterplot for house ages and prices with quadratic line of best fit.

Hint: `geom_smooth()` may help you to construct the linear regression line. You can specify the points with `size = 1`, `alpha = 0.4`,
the fitting line with `size = 0.5`, `color = "tomato"`.

```{r}
library(mosaicData)
data(SaratogaHouses)

ggplot(SaratogaHouses, aes(x = age, y = price)) +
  geom_point(size = 1, alpha = 0.4, color = "cornflowerblue") +
  geom_smooth(method = "lm", formula = y ~ poly(x, 1), se = TRUE, size = 0.5, color = "tomato") +
  labs(title = "Age vs. Price",
       subtitle = "Houses in Saratoga",
       x = "Age of House",
       y = "Price")
```
